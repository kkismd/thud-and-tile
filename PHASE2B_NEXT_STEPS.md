# 🚀 Phase 2B: CLI Inputマッピング実装 - 次のステップ

## 現在の状況
**Phase 2A: CLI Layer基盤作成** ✅ **完了**
- 日時: 2025年10月8日完了
- Git Tag: `phase2a-completed`
- 3-Layer Architecture基盤確立済み

## Phase 2B の目標
**CLI Inputマッピング実装** - キーボード入力からゲームコマンドへの変換機能実装

### 具体的な実装内容
1. **キーボード入力検出**
   - Crossterm使用したリアルタイム入力処理
   - 非ブロッキング入力処理実装

2. **入力マッピング定義**
   - キー → ゲームコマンド変換テーブル
   - カスタマイズ可能な設定システム

3. **ゲームコマンド変換**
   - `CoreGameEvent`への適切な変換
   - タイミング制御（連続入力防止等）

4. **CLI特化機能**
   - デバッグ用キー表示
   - 入力履歴管理

## 準備完了項目
✅ **CLI Layer基盤** - Phase 2Aで完成  
✅ **アーキテクチャ** - 正しい3-Layer分離実現  
✅ **コンパイル環境** - エラーゼロ状態  
✅ **テスト基盤** - `main_phase2a.rs`パターン確立  

## Phase 2B で利用可能なリソース

### 既存モジュール
- `src/cli/cli_input_handler_simple.rs` - 基本構造あり、拡張対象
- `src/cli/cli_game_state.rs` - 入力イベント統合対象
- `src/core/input_handler.rs` - Core Layer入力処理参考

### 参考実装
- Phase 2Aで確立されたレイヤー分離パターン
- エラー解決の段階的アプローチ手法
- CLI Layer → Core Layer連携方式

## リスク評価（Phase 2A学習反映）

### 低リスク要素
- アーキテクチャ基盤確立済み
- 既存入力処理コードを参考可能
- Crosstermライブラリ導入済み

### 中リスク要素
- キー入力のタイミング制御複雑性
- ゲームループとの統合調整
- 非ブロッキング処理の実装難易度

### 対策
- Phase 2A同様の段階的実装
- 小単位でのコンパイル確認
- ユーザーとの協力的問題解決継続

## 推奨実装順序

1. **基本キー検出機能** (低リスク)
2. **基本コマンド変換** (低リスク)  
3. **ゲーム状態との統合** (中リスク)
4. **高度な入力制御** (中-高リスク)
5. **テスト・デバッグ機能** (低リスク)

## 成功指標

### 技術的指標
- ✅ コンパイル成功
- ✅ 基本キー入力検出動作
- ✅ ゲームコマンド変換動作
- ✅ メインループ統合成功

### 品質指標  
- ✅ 正しいレイヤー分離維持
- ✅ レスポンス性能確保
- ✅ エラーハンドリング実装

---

**Phase 2A の学習成果を活かし、Phase 2B も着実に進めていきましょう！** 🎯